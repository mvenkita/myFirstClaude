import{r as t,j as e,T as se,a as ae,b as f,c as g,C as N,d as b,e as v,f as x,A as re,g as te,h as le,i as ne,I as p,S as ce,k as ie,l as oe,m as de,n as y,B as H,o as he}from"./index-pOMHVxr7.js";const me=()=>{const[C,B]=t.useState(""),[A,O]=t.useState(""),[k,G]=t.useState(""),[I,U]=t.useState("add"),[M,E]=t.useState(null),[T,j]=t.useState(""),[P,V]=t.useState(""),[L,F]=t.useState("");t.useState([]);const[W,q]=t.useState([]),[D,_]=t.useState([]),[S,$]=t.useState(""),[R,w]=t.useState(""),z=s=>{if(s<=1)return!1;for(let a=2;a<=Math.sqrt(s);a++)if(s%a===0)return!1;return!0},J=()=>{j(""),E(null);const s=parseInt(C),a=parseInt(A),r=parseInt(k);if(isNaN(s)||isNaN(a)||isNaN(r)){j("Please enter valid numbers");return}if(!z(r)){j("Modulus must be a prime number");return}let l;switch(I){case"add":l=(s+a)%r;break;case"subtract":l=((s-a)%r+r)%r;break;case"multiply":l=s*a%r;break;case"divide":const n=((i,u)=>{for(let m=1;m<u;m++)if(i*m%u===1)return m;return null})(a,r);if(n===null){j("Division not possible (no multiplicative inverse)");return}l=s*n%r;break;default:j("Invalid operation");return}E(l)},Q=async()=>{if(!S){w("");return}try{const a=new TextEncoder().encode(S),r=await crypto.subtle.digest("SHA-256",a),o=Array.from(new Uint8Array(r)).map(n=>n.toString(16).padStart(2,"0")).join("");w(o)}catch(s){console.error("Hashing error:",s),w("Error generating hash")}},d=async s=>{if(!s)return"";try{const r=new TextEncoder().encode(s),l=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(l)).map(i=>i.toString(16).padStart(2,"0")).join("")}catch(a){return console.error("Hashing failed:",a),""}},[c,X]=t.useState({leaf1:"",leaf2:"",leaf3:"",leaf4:"",leaf5:"",leaf6:"",leaf7:"",leaf8:""}),[h,Y]=t.useState({node1:"",node2:"",node3:"",node4:"",node5:"",node6:"",root:""});t.useEffect(()=>{(async()=>{const a=await d(c.leaf1+c.leaf2),r=await d(c.leaf3+c.leaf4),l=await d(c.leaf5+c.leaf6),o=await d(c.leaf7+c.leaf8),n=await d(a+r),i=await d(l+o),u=await d(n+i);Y({node1:a,node2:r,node3:l,node4:o,node5:n,node6:i,root:u})})()},[c]);const Z=(s,a)=>{X(r=>({...r,[s]:a}))};t.useState(0),t.useState(null);const K=()=>{const s=parseInt(P,10),a=parseInt(L,10);if(isNaN(s)||s<=0){alert("Please enter a valid positive number as the secret.");return}const r=[s,...Array(3).fill(0).map(()=>Math.floor(Math.random()*100)%a)];q(r);const l=(n,i)=>n.reduce((u,m,ee)=>(u+m*Math.pow(i,ee))%a,0),o=Array.from({length:7},(n,i)=>l(r,i));_(o)};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-6",children:"Modules"}),e.jsxs(se,{defaultValue:"modular-arithmetic",className:"w-full",children:[e.jsxs(ae,{className:"grid w-full grid-cols-4",children:[e.jsx(f,{value:"modular-arithmetic",children:"Modular Arithmetic"}),e.jsx(f,{value:"sha256-hash",children:"SHA256 Hash"}),e.jsx(f,{value:"merkle",children:"Merkle Tree"}),e.jsx(f,{value:"shamir",children:"Secret Sharing"})]}),e.jsx(g,{value:"modular-arithmetic",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(v,{children:"Modular Arithmetic Calculator"})}),e.jsxs(x,{children:[e.jsx(re,{type:"single",collapsible:!0,className:"w-full mb-4",children:e.jsxs(te,{value:"introduction",children:[e.jsx(le,{children:"What is Modular Arithmetic?"}),e.jsx(ne,{children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsx("p",{children:'Modular arithmetic is like a mathematical clock where numbers "wrap around" after reaching a certain point (the modulus). When using a prime number as the modulus, we create a special mathematical structure called a finite field.'}),e.jsx("h3",{className:"font-semibold mt-2",children:"Key Characteristics:"}),e.jsxs("ul",{className:"list-disc pl-5",children:[e.jsx("li",{children:'Uses a prime number p as the "clock face"'}),e.jsxs("li",{children:["Contains integers ","{0, 1, 2, ..., p-1}"]}),e.jsx("li",{children:"All arithmetic operations are performed modulo p"})]}),e.jsx("h3",{className:"font-semibold mt-2",children:"Operations Examples (mod 7):"}),e.jsxs("div",{className:"bg-gray-100 p-2 rounded",children:[e.jsx("p",{children:"Addition: 3 + 5 = 8 ≡ 1 (mod 7)"}),e.jsx("p",{children:"Multiplication: 3 * 4 = 12 ≡ 5 (mod 7)"}),e.jsx("p",{children:"Subtraction: 3 - 5 = -2 ≡ 5 (mod 7)"})]}),e.jsx("p",{className:"mt-2",children:"Applications include cryptography, error correction, and computer security algorithms."})]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(p,{type:"number",placeholder:"First Number",value:C,onChange:s=>B(s.target.value)}),e.jsxs(ce,{value:I,onValueChange:U,children:[e.jsx(ie,{children:e.jsx(oe,{})}),e.jsxs(de,{children:[e.jsx(y,{value:"add",children:"+"}),e.jsx(y,{value:"subtract",children:"-"}),e.jsx(y,{value:"multiply",children:"×"}),e.jsx(y,{value:"divide",children:"÷"})]})]}),e.jsx(p,{type:"number",placeholder:"Second Number",value:A,onChange:s=>O(s.target.value)})]}),e.jsx(p,{type:"number",placeholder:"Prime Modulus",value:k,onChange:s=>G(s.target.value)}),e.jsx(H,{onClick:J,className:"w-full",children:"Calculate"}),T&&e.jsx("div",{className:"text-red-500 text-center",children:T}),M!==null&&e.jsxs("div",{className:"text-center text-xl font-bold",children:["Result: ",M]})]})]})]})}),e.jsx(g,{value:"sha256-hash",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(v,{children:"SHA256 Hash Generator"})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{placeholder:"Enter string to hash",value:S,onChange:s=>$(s.target.value)}),e.jsx(H,{onClick:Q,className:"w-full",children:"Generate Hash"}),R&&e.jsxs("div",{className:"break-words",children:[e.jsx("strong",{children:"Hash:"}),e.jsx("span",{className:"block bg-gray-100 p-2 rounded mt-2",children:R})]})]})})]})}),e.jsx(g,{value:"merkle",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(v,{children:"Merkle Tree"})}),e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-48",children:[e.jsx("strong",{children:"Root Hash:"}),e.jsx("p",{className:"break-words",children:h.root})]}),e.jsxs("div",{className:"flex space-x-8",children:[e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-36",children:[e.jsx("strong",{children:"Node 5 Hash:"}),e.jsx("p",{className:"break-words",children:h.node5})]}),e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-36",children:[e.jsx("strong",{children:"Node 6 Hash:"}),e.jsx("p",{className:"break-words",children:h.node6})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-24",children:[e.jsx("strong",{children:"Node 1 Hash:"}),e.jsx("p",{className:"break-words",children:h.node1})]}),e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-24",children:[e.jsx("strong",{children:"Node 2 Hash:"}),e.jsx("p",{className:"break-words",children:h.node2})]}),e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-24",children:[e.jsx("strong",{children:"Node 3 Hash:"}),e.jsx("p",{className:"break-words",children:h.node3})]}),e.jsxs("div",{className:"bg-gray-200 px-2 py-1 rounded text-xs w-24",children:[e.jsx("strong",{children:"Node 4 Hash:"}),e.jsx("p",{className:"break-words",children:h.node4})]})]}),e.jsx("div",{className:"grid grid-cols-8 gap-2",children:["leaf1","leaf2","leaf3","leaf4","leaf5","leaf6","leaf7","leaf8"].map(s=>e.jsx("input",{type:"text",placeholder:`Leaf ${s.slice(-1)}`,value:c[s],onChange:a=>Z(s,a.target.value),className:"border p-1 text-xs"},s))})]})})]})}),e.jsx(g,{value:"shamir",children:e.jsxs(N,{className:"max-w-md mx-auto mt-10",children:[e.jsx(b,{children:e.jsx(v,{children:"Shamir's Secret Sharing"})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Enter Secret (Number):"}),e.jsx(p,{type:"number",value:P,onChange:s=>V(s.target.value),placeholder:"Enter a secret number"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Enter Prime (Number):"}),e.jsx(p,{type:"number",value:L,onChange:s=>F(s.target.value),placeholder:"Enter a prime number"})]})}),e.jsx(he,{children:e.jsx(H,{onClick:K,className:"w-full",children:"Generate Shares"})}),e.jsxs(x,{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Polynomial Coefficients:"}),e.jsx("ul",{className:"list-disc pl-5",children:W.map((s,a)=>e.jsxs("li",{children:["Coefficient of x^",a,": ",s]},a))}),e.jsx("h3",{className:"text-lg font-semibold mt-4",children:"Shares:"}),e.jsx("ul",{className:"list-disc pl-5",children:D.map((s,a)=>e.jsxs("li",{children:["Server ",a+1,"'s share is ",s,". This is p(",a,")."]},a))})]})]})})]}),e.jsx("footer",{className:"text-center text-sm text-gray-500 mt-6",children:"© 2024 Ligero Inc."})]})};export{me as default};
